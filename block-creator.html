<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Block Creator</title>
    <link rel="stylesheet" href="/src/shared/styles/theme.css">
    <link rel="stylesheet" href="/src/creator/block-creator.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body data-theme="light"> 

    <div class="creator-container">
        <header class="creator-header">
            <h1><svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>Custom Block Creator</h1>
            <div class="header-actions">
                <a href="index.html" class="btn secondary">
                    <svg viewBox="0 0 24 24"><path d="M19 12H5m7 7-7-7 7-7" /></svg> Back to Projects
                </a>
                <button id="save-block-btn" class="btn primary">
                    <svg viewBox="0 0 24 24"><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5.586a1 1 0 0 1 .707.293l5.414 5.414a1 1 0 0 1 .293.707V12z" /><path d="M12 3v4a1 1 0 0 0 1 1h4" /><path d="M12 18a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" /></svg>
                    Save to File
                </button>
            </div>
        </header>

        <main class="creator-grid">
            <!-- Left Column: Configuration -->
            <aside class="configuration-panel">
                <div class="panel-header"><h3>1. Configure Your Block</h3></div>
                <div class="panel-content">
                    <div class="config-section">
                        <label for="block-name">Block Text</label>
                        <input type="text" id="block-name" placeholder="e.g., run motor at speed %1">
                        <p class="help-text">Use <code>%1</code>, <code>%2</code>, etc., to mark where inputs will appear.</p>
                    </div>

                    <div class="config-section">
                        <label for="block-tooltip">Help Text (Tooltip)</label>
                        <textarea id="block-tooltip" rows="2" placeholder="e.g., Runs a motor at a given speed."></textarea>
                    </div>

                    <div class="config-section dual-grid">
                        <div>
                            <label for="block-color">Color</label>
                            <input type="color" id="block-color" value="#5b67e8">
                        </div>
                        <div>
                             <label for="block-style">Style</label>
                            <select id="block-style">
                                <option value="logic_blocks">Logic</option>
                                <option value="loop_blocks">Loops</option>
                                <option value="math_blocks">Math</option>
                                <option value="text_blocks">Text</option>
                                <option value="list_blocks">Lists</option>
                                <option value="variable_blocks">Variables</option>
                            </select>
                        </div>
                    </div>

                    <div class="config-section">
                        <label>Connections</label>
                        <div class="connection-grid">
                            <label class="checkbox-label"><input type="checkbox" id="conn-prev"> Top Connector</label>
                            <label class="checkbox-label"><input type="checkbox" id="conn-next"> Bottom Connector</label>
                            <label class="checkbox-label"><input type="checkbox" id="conn-output"> Left Connector (Output)</label>
                        </div>
                         <div id="output-type-wrapper" class="hidden">
                            <label for="output-type">Output Type Check</label>
                            <input type="text" id="output-type" placeholder="e.g., String, Number, Boolean (optional)">
                        </div>
                    </div>
                     <div class="config-section">
                        <label>Appearance</label>
                        <label class="checkbox-label"><input type="checkbox" id="inputs-inline"> Inputs Inline</label>
                    </div>


                    <div class="config-section inputs-section">
                        <label>Inputs & Fields</label>
                        <div id="inputs-list"></div>
                        <div class="add-input-form">
                            <select id="new-input-type">
                                <option value="input_value">Value Input (Number, String, etc)</option>
                                <option value="field_input">Text Field</option>
                                <option value="field_number">Number Field</option>
                                <option value="field_angle">Angle Field</option>
                                <option value="field_checkbox">Checkbox</option>
                                <option value="field_colour">Color Field</option>
                                <option value="field_dropdown">Dropdown Field</option>
                            </select>
                            <button id="add-input-btn" title="Add Input Field">+</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Center Column: Live Preview -->
            <section class="preview-panel">
                <div class="panel-header"><h3>2. Live Preview</h3></div>
                <div id="block-preview-wrapper">
                    <svg id="preview-svg" width="300" height="100">
                        <path id="preview-path" fill="#5b67e8" d="M0,0 H150 V50 H0 Z"></path>
                        <g id="preview-content" class="block-content"></g>
                    </svg>
                </div>
            </section>

            <!-- Right Column: Code Generation -->
            <section class="code-panel">
                <div class="panel-header"><h3>3. Define the Code</h3></div>
                <div class="panel-content">
                    <div class="code-section">
                        <label for="python-template">MicroPython Code Template</label>
                        <p class="help-text">Use <code>{{INPUT_NAME}}</code> to insert values. For an output block, just provide the value to return.</p>
                        <textarea id="python-template" rows="8" placeholder="e.g., motor.run(pin={{PIN}}, speed={{SPEED}})"></textarea>
                    </div>
                    <div class="code-section">
                        <label>Generated JSON Output (for IDE)</label>
                        <textarea id="generated-json-output" readonly></textarea>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script type="module" src="/src/creator/block-creator.js"></script>
</body>
</html>